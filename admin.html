<!DOCTYPE html>
<html>
<head>
  <title>Admin Panel</title>
</head>
<body>
  <h2>Payment Requests</h2>
  <div id="payments"></div>

  <script>
    async function loadPayments() {
      const res = await fetch("/payments"); // üîπ now calls DB API
      const payments = await res.json();
      const div = document.getElementById("payments");
      div.innerHTML = "";

      payments.forEach(p => {
        div.innerHTML += `
          <p>
            ${p.name} (${p.email}) - ${p.upiRef} 
            [${p.verified === true ? "‚úÖ Approved" : p.verified === false ? "‚ùå Rejected" : "‚è≥ Pending"}]
            <button onclick="approve(${p.id})">Accept</button>
            <button onclick="reject(${p.id})">Reject</button>
          </p>`;
      });
    }

    // Approve payment
    async function approve(id) {
      await fetch(`/approve-payment/${id}`, { method: "POST" });
      loadPayments();
    }

    // Reject payment
    async function reject(id) {
      await fetch(`/reject-payment/${id}`, { method: "POST" });
      loadPayments();
    }

    // Initial load
    loadPayments();
  </script>
 <h2>Load Answer Request</h2>
<div id="discussion"></div>


<script>
    async function loadDiscussion() {
      const res = await fetch("/list-discussion"); // üîπ now calls DB API
      const disc = await res.json();
      const div = document.getElementById("discussion");
      div.innerHTML = "";

      disc.forEach(p => {
        div.innerHTML += `
          <p>
            ${p.question} (${p.answer}) 
            [${p.status === true ? "‚úÖ Approved" : p.status === false ? "‚ùå Rejected" : "‚è≥ Pending"}]
            <button onclick="approve1(${p.id},${p.question},${p.answer})">Accept</button>
            <button onclick="reject1(${p.id})">Reject</button>
          </p>`;
      });
    }

    // Approve payment

  
    async function approve1(id,question,answer) {
      fetch("https://apexappnew.onrender.com/approve-ans", {
        method: "POST",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify({ id:id,question:question,answer:answer})
      });

      //await fetch(`/approve-ans?id=${id}`, { method: "POST" });
      loadDiscussion();
    }

    // Reject payment
    async function reject1(id) {
      await fetch(`/reject-ans?id=${id}`, { method: "POST" });
      loadDiscussion();
    }

    // Initial load
    loadDiscussion();
  </script>




</body>
</html>










